<head>
    <script src="https://unpkg.com/construct-style-sheets-polyfill"></script>
    <script src="https://polyfill.io/v3/polyfill.js?features=Array.prototype.map,fetch,Promise"></script>
     <style>
    body{
    background-color: transparent;
    }
    body {
  background: transparent;
}
    .wrapper {
      margin: 1rem auto;
      max-width: 800px;
        background: transparent;
    }
    </style>
</head>

<script>
let query = ""
let type = ""
let theme = ""
function setContent(x, y, z){
  query = x 
  type =  y
  theme = z  
}
function addAPIkey(){
  
  /// Add Markdown Parser To Document

   


  
var script = document.createElement("script");

// Add script content
var B = `const TheMovieDB_APIKey = "249f222afb1002186f4d88b2b5418b55"`
  
script.innerHTML = B

// Append

document.head.appendChild(script);
  
  
  console.log(script)
  
  // On Error Loading Markdown Parser


  
  /// Markdown Parser Load Successful 
}


function loadMarkdownParser(url){
  
  /// Add Markdown Parser To Document
var script = document.createElement('script');
script.src = url;
script.type = "module"
document.head.appendChild(script); //or something of the likes  
  
  
  console.log(script)
  
  // On Error Loading Markdown Parser
script.onerror = function () {
 
  console.error("Markdown Tag: Error while performing function LoadMarkdownParser - There was an error loading the Markdown Parser")
  
}

  
  /// Markdown Parser Load Successful 
script.onload = function () {
 
  // Let the Magic Begin 
  
  

       document.body.innerHTML = `
    <head>
      <style>
    body{
    background-color: transparent;
    }
    body {
  background: transparent;
}
    .wrapper {
      margin: 1rem auto;
      max-width: 800px;
        background: transparent;
    }
    </style>
  <title>Demo</title>
  	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
</head>

<div class='Wrapper'>
  

  

<media-element id="test" name="${query}" ${theme} ${type}></media-element>
 `
  
};
}
if (window.location.href.indexOf("search") != -1) {

window.onload=function(){
     var url_string = window.location.href
      var url = new URL(url_string);
var c = url.searchParams.get("type");
  
if (c === "song"){
 type = `type="song"`
}
if (c === "tv"){
 type = `type="tv"`
}  
if (c === "movie"){
 type = ``
}
if (url.searchParams.get("theme")){
 theme = `theme="dark"`
}    

var name = url.searchParams.get("name");  

     if (name === null){
document.body.innerHTML = "No search route provided"
       
     } 
  
     if (c === null){
document.body.innerHTML = "No search route provided"
       
     }else{
addAPIkey()
setContent(name, type, theme)
      
    loadMarkdownParser('https://cdn.jsdelivr.net/gh/MarketingPipeline/Media-Card-Web-Component@latest/dist/media-card-wc.min.js');
       
     }


}} 

</script>  
